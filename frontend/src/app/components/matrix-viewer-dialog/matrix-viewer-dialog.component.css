               :host {
                  --mv-func-w: 9rem;
                  --mv-subfunc-w: 9rem;
                  --mv-comp-w: 9rem;
                  --mv-top-1-h: 3rem;
                  --mv-top-2-h: 4rem;
                  --mv-border: 1px solid var(--theme-border-color, #d1d5db);
                  --mv-bg: var(--theme-card-bg, #fff);
                  --mv-bg-head: var(--theme-form-bg, #f3f4f6);
                  --mv-text: var(--theme-text, #111827);
                  --mv-muted: var(--theme-text-secondary, #6b7280);
                  --mv-accent: #7120bd;
                  --mv-shadow: 0 18px 40px rgba(0, 0, 0, 0.18);
              }
              /* overlay e dialog */
              
              .mv-overlay {
                  position: fixed;
                  inset: 0;
                  background: rgba(0, 0, 0, 0.55);
                  display: grid;
                  place-items: center;
                  z-index: 9999;
              }
              
              .mv-dialog {
                  background: var(--mv-bg);
                  color: var(--mv-text);
                  border-radius: 12px;
                  width: min(1200px, 96vw);
                  max-height: 92vh;
                  box-shadow: var(--mv-shadow);
                  overflow: hidden;
                  display: flex;
                  flex-direction: column;
              }
              
              .mv-header {
                  position: sticky;
                  top: 0;
                  z-index: 60;
                  background: linear-gradient(90deg, #667eea, #764ba2);
                  color: #fff;
                  padding: 0.75rem 3.5rem 0.75rem 1rem;
              }
              
              .mv-header h2 {
                  margin: 0;
                  font-weight: 700;
                  font-size: 1em;
              }
              
              .mv-close {
                  position: absolute;
                  right: 0.75rem;
                  top: 0.5rem;
                  width: 2.25rem;
                  height: 2.25rem;
                  border-radius: 999px;
                  background: rgba(255, 255, 255, 0.15);
                  color: #fff;
                  border: 2px solid rgba(255, 255, 255, 0.35);
                  font-size: 1.25em;
                  line-height: 1;
                  cursor: pointer;
              }
              
              .mv-close:hover {
                  background: rgba(255, 255, 255, 0.28);
              }
              
              .mv-body {
                  padding: 0;
              }
              
              .mv-loading,
              .mv-error {
                  padding: 1rem;
              }
              
              .mv-error {
                  color: #b91c1c;
              }
              
              .mv-meta {
                  display: grid;
                  grid-template-columns: repeat(4, 1fr);
                  gap: 0.5rem 0.75rem;
                  padding: 0.75rem 1rem;
                  border-bottom: var(--mv-border);
                  background: var(--mv-bg);
                  position: sticky;
                  top: 0;
                  z-index: 55;
              }
              
              .mv-meta strong {
                  color: var(--mv-muted);
              }
              
              .mv-grid {
                  overflow: auto;
                  max-height: 70vh;
                  min-height: 16rem;
              }
              
              .mv-table {
                  border-collapse: separate;
                  border-spacing: 0;
                  width: max-content;
                  min-width: 100%;
                  table-layout: fixed;
                  background: var(--mv-bg);
                  color: var(--mv-text);
              }
              
              .mv-table th,
              .mv-table td {
                  border: var(--mv-border);
                  background-clip: padding-box;
              }
              
              .th-top-1 {
                  position: sticky;
                  top: 0;
                  z-index: 30;
                  height: var(--mv-top-1-h);
                  background: var(--mv-bg-head);
              }
              
              .th-top-2 {
                  position: sticky;
                  top: var(--mv-top-1-h);
                  z-index: 29;
                  height: var(--mv-top-2-h);
                  background: var(--mv-bg-head);
              }
              
              .th-top-1>button {
                  text-align: center;
              }
              
              .th-left-1 {
                  position: sticky;
                  left: 0;
                  z-index: 50;
                  width: var(--mv-func-w);
                  min-width: var(--mv-func-w);
                  max-width: var(--mv-func-w);
                  background: var(--mv-bg-head);
              }
              
              .th-left-2 {
                  position: sticky;
                  left: var(--mv-func-w);
                  z-index: 49;
                  width: var(--mv-subfunc-w);
                  min-width: var(--mv-subfunc-w);
                  max-width: var(--mv-subfunc-w);
                  background: var(--mv-bg-head);
              }
              
              .th-left-1.th-top-1 {
                  z-index: 58;
              }
              
              .th-left-2.th-top-1 {
                  z-index: 57;
              }
              
              .th-left-1.th-top-2 {
                  z-index: 56;
              }
              
              .th-left-2.th-top-2 {
                  z-index: 55;
              }
              
              .corner {
                  text-align: center;
                  font-weight: 700;
              }
              
              .th-cat {
                  text-align: center;
                  padding: 0.25rem 0.5rem;
              }
              
              .th-comp {
                  width: var(--mv-comp-w);
                  min-width: var(--mv-comp-w);
                  max-width: var(--mv-comp-w);
                  text-align: center;
                  padding: 0.25rem 0.5rem;
                  vertical-align: bottom;
              }
              
              .th-funcao {
                  vertical-align: top;
                  padding: 0.5rem;
              }
              
              .th-subfunc {
                  vertical-align: top;
                  padding: 0.5rem;
              }
              
              .hdr-text,
              .subf-text {
                  display: -webkit-box;
                  -webkit-box-orient: vertical;
                  overflow: hidden;
                  white-space: normal;
                  word-break: break-word;
                  overflow-wrap: anywhere;
                  width: 100%;
                  border: none;
                  background: none;
                  color: inherit;
                  cursor: pointer;
                  text-align: left;
                  padding: 0;
                  margin: 0;
                  line-height: 1.25;
                  font: inherit;
              }
              
              .hdr-text.func {
                  line-clamp: 3;
                  -webkit-line-clamp: 3;
                  font-size: 0.9em;
              }
              
              .hdr-text.subf {
                  line-clamp: 3;
                  -webkit-line-clamp: 3;
                  font-size: 0.875em;
              }
              
              .hdr-text.cat {
                  line-clamp: 3;
                  -webkit-line-clamp: 2;
                  font-size: 0.85em;
              }
              
              .hdr-text.comp {
                  line-clamp: 3;
                  -webkit-line-clamp: 2;
                  font-size: 0.82em;
              }
              
              .hdr-text.expanded {
                  line-clamp: 3;
                  -webkit-line-clamp: unset;
              }
              
              .subf-text.expanded {
                  line-clamp: 3;
                  -webkit-line-clamp: unset;
              }
              
              .cell {
                  width: var(--mv-comp-w);
                  min-width: var(--mv-comp-w);
                  max-width: var(--mv-comp-w);
                  text-align: center;
                  padding: 0.375rem 0.25rem;
                  background: var(--mv-bg);
              }
              
              .muted {
                  color: var(--mv-muted);
                  font-size: 0.85rem;
              }
              
              .codes {
                  display: flex;
                  gap: 0.25rem;
                  justify-content: center;
                  flex-wrap: wrap;
              }
              
              .code {
                  display: inline-flex;
                  align-items: center;
                  justify-content: center;
                  min-width: 1.375rem;
                  height: 1.375rem;
                  padding: 0 0.375rem;
                  border-radius: 0.375rem;
                  font-size: 0.82rem;
                  text-decoration: none;
                  border: 1px solid rgba(0, 0, 0, 0.08);
                  color: var(--mv-accent);
                  background: rgba(113, 32, 189, 0.06);
              }
              
              .code:hover {
                  background: rgba(113, 32, 189, 0.14);
              }
              
              .mv-popover {
                  position: fixed;
                  z-index: 70;
                  width: 16rem;
                  max-width: calc(100vw - 20px);
                  /* background: #111827; */
                  background: rgba(102, 125, 233, 0.9);
                  color: #f9fafb;
                  border-radius: 8px;
                  padding: 0.6rem 0.75rem;
                  font-size: 0.85em;
                  box-shadow: 0 10px 24px rgba(0, 0, 0, 0.35);
              }
              
              .mv-grid::-webkit-scrollbar {
                  height: 10px;
                  width: 10px;
              }
              
              .mv-grid::-webkit-scrollbar-thumb {
                  background: #a7a7a7;
                  border-radius: 6px;
              }
              
              .mv-grid::-webkit-scrollbar-track {
                  background: transparent;
              }
              /* ======================= Dark Theme ======================= */
              
               :host-context(.dark-theme) .mv-dialog,
               :host-context([data-theme="dark"]) .mv-dialog {
                  background: #1a1a1a !important;
                  color: var(--color-highlight-neon)!important;
                  border: 1px solid #333333 !important;
              }
              
               :host-context(.dark-theme) .mv-header,
               :host-context([data-theme="dark"]) .mv-header {
                  background: linear-gradient(135deg, #a855f7 0%, #8b5cf6 100%) !important;
                  border-bottom: 1px solid #333333 !important;
              }
              
               :host-context(.dark-theme) .mv-header h2,
               :host-context([data-theme="dark"]) .mv-header h2 {
                  color: #ffffff !important;
              }
              
               :host-context(.dark-theme) .mv-close,
               :host-context([data-theme="dark"]) .mv-close {
                  background: rgba(255, 255, 255, 0.08) !important;
                  border: 1px solid rgba(255, 255, 255, 0.24) !important;
                  color: #ffffff !important;
              }
              
               :host-context(.dark-theme) .mv-close:hover,
               :host-context([data-theme="dark"]) .mv-close:hover {
                  background: rgba(255, 255, 255, 0.16) !important;
                  border-color: rgba(255, 255, 255, 0.4) !important;
              }
              
               :host-context(.dark-theme) .mv-meta,
               :host-context([data-theme="dark"]) .mv-meta {
                  background: #121212 !important;
                  border: 1px solid #333333 !important;
                  color: #e5e7eb !important;
              }
              
               :host-context(.dark-theme) .mv-grid,
               :host-context([data-theme="dark"]) .mv-grid {
                  background: #101010 !important;
                  border: 1px solid #333333 !important;
              }
              
               :host-context(.dark-theme) .mv-table,
               :host-context([data-theme="dark"]) .mv-table {
                  color: #e5e7eb !important;
                  background: transparent !important;
              }
              
               :host-context(.dark-theme) .mv-table th,
               :host-context([data-theme="dark"]) .mv-table th {
                  background: #202020 !important;
                  color: #ffffff !important;
                  border-color: #333333 !important;
              }
              
               :host-context(.dark-theme) .mv-table td,
               :host-context([data-theme="dark"]) .mv-table td {
                  background: #1a1a1a !important;
                  border-color: #333333 !important;
              }
              
               :host-context(.dark-theme) .mv-table tbody tr:nth-child(odd) td,
               :host-context([data-theme="dark"]) .mv-table tbody tr:nth-child(odd) td {
                  background: #151515 !important;
              }
              
               :host-context(.dark-theme) .code,
               :host-context([data-theme="dark"]) .code {
                  color: #c4b5fd !important;
                  background: rgba(139, 92, 246, 0.12) !important;
                  border: 1px solid rgba(168, 85, 247, 0.3) !important;
              }
              
               :host-context(.dark-theme) .code:hover,
               :host-context([data-theme="dark"]) .code:hover {
                  background: rgba(168, 85, 247, 0.2) !important;
              }
              
               :host-context(.dark-theme) .mv-tooltip,
               :host-context([data-theme="dark"]) .mv-tooltip {
                  background: #0b0b0b !important;
                  color: #e5e7eb !important;
                  border: 1px solid #333333 !important;
                  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.5) !important;
              }
              
               :host-context(.dark-theme) .mv-grid,
               :host-context([data-theme="dark"]) .mv-grid {
                  scrollbar-color: #444444 #111111;
              }
              
               :host-context(.dark-theme) .mv-grid::-webkit-scrollbar-thumb,
               :host-context([data-theme="dark"]) .mv-grid::-webkit-scrollbar-thumb {
                  background: #444444;
                  border: 3px solid #1a1a1a;
              }
              
               :host-context(.dark-theme) .mv-grid::-webkit-scrollbar-track,
               :host-context([data-theme="dark"]) .mv-grid::-webkit-scrollbar-track {
                  background: #111111;
              }
              
               :host-context(.dark-theme) .muted,
               :host-context([data-theme="dark"]) .muted {
                  color: #9ca3af !important;
              }
              
               :host-context(.dark-theme) .mv-popover {
                  background: rgba(59, 32, 110, 0.9) !important;
                  color: var(--color-highlight-neon) !important;
              }
              /* ======================= ALTO CONTRASTE ======================= */
              
               :host-context(.high-contrast) .mv-dialog {
                  background: black !important;
                  color: white !important;
                  border: 2px solid var(--color-highlight-neon) !important;
              }
              
               :host-context(.high-contrast) .mv-header {
                  background: black !important;
                  border-bottom: 2px solid var(--color-highlight-neon) !important;
              }
              
               :host-context(.high-contrast) .mv-header h2 {
                  color: white !important;
              }
              
               :host-context(.high-contrast) .mv-close {
                  background: black !important;
                  color: var(--color-highlight-neon) !important;
                  border: 2px solid var(--color-highlight-neon) !important;
              }
              
               :host-context(.high-contrast) .mv-close:hover {
                  filter: brightness(1.3);
              }
              
               :host-context(.high-contrast) .mv-table th,
               :host-context(.high-contrast) .mv-table td {
                  background: black !important;
                  color: white !important;
                  border-color: var(--color-highlight-neon) !important;
              }
              
               :host-context(.high-contrast) .th-funcao,
               :host-context(.high-contrast) .th-subfuncao,
               :host-context(.high-contrast) .th-cat,
               :host-context(.high-contrast) .th-comp {
                  background: black !important;
                  color: white !important;
                  border-bottom: 2px solid var(--color-highlight-neon) !important;
              }
              
               :host-context(.high-contrast) .code {
                  color: black !important;
                  background: var(--color-highlight-neon) !important;
                  border: 2px solid var(--color-highlight-neon) !important;
              }
              
               :host-context(.high-contrast) .code:hover {
                  background: rgba(255, 255, 0, 0.8) !important;
              }
              
               :host-context(.high-contrast) .mv-tooltip,
               :host-context(.high-contrast) .mv-popover {
                  background: black !important;
                  color: var(--color-highlight-neon) !important;
                  border: 2px solid var(--color-highlight-neon) !important;
                  box-shadow: none !important;
              }